{
  "permissions": {
    "allow": [
      "Bash(python:*)",
      "Bash(py:*)",
      "Bash(where:*)",
      "Bash(ls:*)",
      "Bash(node --version:*)",
      "Bash(npm --version:*)",
      "Bash(npm test)",
      "Bash(\"C:/Users/kanis/Desktop/MKCP/TALLY CLAUDE/backend/venv/Scripts/python.exe\" -c:*)",
      "Bash(\"C:/Users/kanis/Desktop/MKCP/TALLY CLAUDE/backend/venv/Scripts/python.exe\" -c \":*)",
      "Bash(venv/Scripts/python.exe:*)",
      "Bash(curl:*)",
      "Bash(iconv:*)",
      "Bash(python3:*)",
      "mcp__Claude_Preview__preview_start",
      "Bash(./venv/Scripts/python:*)",
      "Bash(\"C:/Users/kanis/Desktop/MKCP/TALLY CLAUDE/backend/.venv/Scripts/python.exe\":*)",
      "Bash(set:*)",
      "Bash(netstat:*)",
      "Bash(findstr:*)",
      "Bash(taskkill:*)",
      "Bash(cmd /c \"taskkill /PID 35056 /F\")",
      "Bash(cmd /c \"taskkill /PID 11528 /F\")",
      "Bash(cmd /c \"taskkill /PID 35056 /F && taskkill /PID 11528 /F\")",
      "Bash(cmd /c:*)",
      "Bash(powershell -Command:*)",
      "Bash(npm run build:*)",
      "Bash(\"C:/Users/kanis/Desktop/MKCP/TALLY CLAUDE/backend/.venv/Scripts/python.exe\" -c \":*)",
      "Bash(xargs -I{} powershell -Command \"Stop-Process -Id {} -Force -ErrorAction SilentlyContinue\")",
      "Bash(kill:*)",
      "Bash(tasklist:*)",
      "Bash(wmic:*)",
      "Bash(xxd:*)",
      "Bash(echo:*)",
      "Bash(cmd //c \"C:\\\\claude-servers\\\\frontend.bat --test\")",
      "Bash(.venvScriptspython.exe -m uvicorn app.main:app --reload --host 0.0.0.0 --port 8000)",
      "Bash(npm run dev:*)",
      "Bash(timeout /t 3 /nobreak)",
      "Bash(.venv/Scripts/python.exe -m uvicorn:*)",
      "Bash(ping:*)",
      "Bash(\"C:/Users/kanis/Desktop/MKCP/TALLY CLAUDE/backend/.venv/Scripts/python.exe\" -c \"from app.main import app; print\\(''Import OK''\\)\")",
      "Bash(.venv/Scripts/python.exe -c \"from app.main import app; print\\(''Import OK''\\)\")",
      "Bash(.venv/Scripts/python.exe -c \"import openpyxl; print\\(''openpyxl OK'', openpyxl.__version__\\)\")",
      "Bash(.venv/Scripts/python.exe -c \":*)",
      "Bash(wc:*)",
      "Bash(find:*)",
      "Bash(npm create vite:*)",
      "Bash(npm install:*)",
      "Bash(npx tailwindcss:*)",
      "Bash(node:*)",
      "Bash(npm run type-check:*)",
      "Bash(npm run:*)",
      "Bash(npm uninstall:*)",
      "Bash(git push:*)",
      "Bash(timeout /t 3)",
      "Bash(\"c:\\\\Users\\\\kanis\\\\Desktop\\\\MKCP\\\\TALLY CLAUDE\\\\frontend\\\\src\\\\workers\\\\xmlParser.worker.ts\" << 'WORKER_EOF'\n// Web Worker for parsing XML files in background thread\n// This prevents UI freezing during large file processing\n\nimport { loadAndSanitizeXmlFile } from \"../xml/sanitizer\";\nimport { parseTallyXml } from \"../xml/parser\";\nimport { normalizeStockItem, normalizeLedger, normalizeUnit, normalizeVoucher } from \"../xml/normalizer\";\nimport type { ParsedData } from \"../types/canonical\";\n\nexport interface WorkerMessage {\n  type: \"parse\";\n  fileData: ArrayBuffer;\n  fileName: string;\n}\n\nexport interface WorkerResponse {\n  type: \"success\" | \"error\";\n  data?: ParsedData;\n  error?: string;\n  fileName: string;\n}\n\n// Handle messages from main thread\nself.onmessage = async \\(e: MessageEvent<WorkerMessage>\\) => {\n  const { type, fileData, fileName } = e.data;\n\n  if \\(type === \"parse\"\\) {\n    try {\n      // Step 1: Load and sanitize\n      const sanitizedXml = loadAndSanitizeXmlFile\\(fileData\\);\n\n      // Step 2: Parse XML\n      const xmlObj = parseTallyXml\\(sanitizedXml\\);\n\n      // Step 3: Extract TALLYMESSAGE arrays\n      let tallyMessages: any[] = [];\n\n      // Check for ENVELOPE > BODY > TALLYMESSAGE structure\n      if \\(xmlObj.ENVELOPE?.BODY?.DATA?.TALLYMESSAGE\\) {\n        const tm = xmlObj.ENVELOPE.BODY.DATA.TALLYMESSAGE;\n        tallyMessages = Array.isArray\\(tm\\) ? tm : [tm];\n      } else if \\(xmlObj.ENVELOPE?.BODY?.TALLYMESSAGE\\) {\n        const tm = xmlObj.ENVELOPE.BODY.TALLYMESSAGE;\n        tallyMessages = Array.isArray\\(tm\\) ? tm : [tm];\n      } else if \\(xmlObj.TALLYMESSAGE\\) {\n        const tm = xmlObj.TALLYMESSAGE;\n        tallyMessages = Array.isArray\\(tm\\) ? tm : [tm];\n      } else if \\(xmlObj.ENVELOPE?.BODY\\) {\n        // Fallback: treat BODY as a single message\n        tallyMessages = [xmlObj.ENVELOPE.BODY];\n      }\n\n      // Step 4: Initialize ParsedData\n      const parsedData: ParsedData = {\n        company: null,\n        ledgers: new Map\\(\\),\n        stockItems: new Map\\(\\),\n        units: new Map\\(\\),\n        vouchers: [],\n        importedAt: new Date\\(\\),\n        sourceFiles: [fileName],\n        warnings: [],\n      };\n\n      // Step 5: Process each TALLYMESSAGE\n      for \\(const msg of tallyMessages\\) {\n        // Extract company info\n        if \\(msg.COMPANY\\) {\n          const companies = Array.isArray\\(msg.COMPANY\\) ? msg.COMPANY : [msg.COMPANY];\n          for \\(const companyRaw of companies\\) {\n            if \\(companyRaw.NAME\\) {\n              parsedData.company = {\n                name: companyRaw.NAME,\n                gstin: companyRaw.GSTIN || companyRaw.COMPANYGSTREGISTRATIONNO,\n                stateName: companyRaw.STATENAME,\n                financialYearBegins: companyRaw.COMPANYFISCALYEARSTARTMONTH,\n              };\n              break;\n            }\n          }\n        }\n\n        // Extract units \\(must be parsed first for stock items\\)\n        const unitsList = msg['UNIT.LIST'] || [];\n        for \\(const unitRaw of unitsList\\) {\n          const unit = normalizeUnit\\(unitRaw\\);\n          if \\(unit\\) {\n            parsedData.units.set\\(unit.symbol, unit\\);\n          }\n        }\n\n        // Extract ledgers\n        const ledgersList = msg['LEDGER.LIST'] || [];\n        for \\(const ledgerRaw of ledgersList\\) {\n          const ledger = normalizeLedger\\(ledgerRaw\\);\n          if \\(ledger\\) {\n            parsedData.ledgers.set\\(ledger.nameNormalized, ledger\\);\n          }\n        }\n\n        // Extract stock items\n        const stockItemsList = msg['STOCKITEM.LIST'] || [];\n        for \\(const itemRaw of stockItemsList\\) {\n          const item = normalizeStockItem\\(itemRaw, parsedData.units\\);\n          if \\(item\\) {\n            parsedData.stockItems.set\\(item.nameNormalized, item\\);\n          }\n        }\n\n        // Extract vouchers\n        const vouchersList = msg['VOUCHER.LIST'] || [];\n        for \\(const voucherRaw of vouchersList\\) {\n          const voucher = normalizeVoucher\\(voucherRaw\\);\n          if \\(voucher\\) {\n            parsedData.vouchers.push\\(voucher\\);\n          }\n        }\n      }\n\n      // Send success response\n      const response: WorkerResponse = {\n        type: \"success\",\n        data: parsedData,\n        fileName,\n      };\n      self.postMessage\\(response\\);\n    } catch \\(error\\) {\n      // Send error response\n      const response: WorkerResponse = {\n        type: \"error\",\n        error: error instanceof Error ? error.message : String\\(error\\),\n        fileName,\n      };\n      self.postMessage\\(response\\);\n    }\n  }\n};\n\n// Export empty object to make TypeScript treat this as a module\nexport {};\nWORKER_EOF)",
      "Bash(git add:*)"
    ]
  }
}
